"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const B=require("react/jsx-runtime"),V=require("@heymantle/client"),c=require("react"),k={Public:"public",CustomerTag:"customerTag",ShopifyPlan:"shopifyPlan",Customer:"customer",Hidden:"hidden"},l={AmountPerInterval:"{{ amount }} per {{ interval }}",Back:"Back",Cancel:"Cancel",CancelConfirmation:"Are you sure you want to cancel your subscription?",CancelPlan:"Cancel plan",ChangePlan:"Change plan",CurrentPlan:"Current plan",CustomPlans:"Custom plans",CustomPlansDescription:"Plans tailored to your specific needs",DiscountAmount:"{{ amount }} discount",DiscountAmountExpired:"{{ amount }} discount expired",FreeTrialLength:"{{ trialDays }}-day free trial",Features:"Features",Month:"month",MonthShort:"mo",Monthly:"Monthly",NextBillingDate:"Next billing date",NotSubscribed:"You're not subscribed to a plan yet.",Year:"year",YearShort:"yr",Yearly:"Yearly",MostPopular:"Most popular",Per:"/",Plans:"Plans",Price:"Price",SelectPlan:"Select plan",SubscribeSuccessTitle:"Subscription successful",SubscribeSuccessBody:"Thanks for subscribing to our app!",Subscription:"Subscription",SubscriptionCancelled:"Subscription cancelled",UsageCharges:"Usage charges",loading:"Loading...",error:"An error occurred",retry:"Retry",cancel:"Cancel",continue:"Continue",subscribe:"Subscribe",subscribeNow:"Subscribe Now",upgradeNow:"Upgrade Now",manageSubscription:"Manage Subscription",cancelSubscription:"Cancel Subscription",addPaymentMethod:"Add Payment Method",updatePaymentMethod:"Update Payment Method",featureNotAvailable:"This feature is not available on your current plan",upgradeRequired:"Upgrade Required",limitReached:"Limit Reached"},h=c.createContext(void 0),T=({feature:e,count:n=0})=>(e==null?void 0:e.type)==="boolean"?e.value:(e==null?void 0:e.type)==="limit"?n<e.value||e.value===-1:!1,j=({appId:e,customerApiToken:n,apiUrl:s="https://appapi.heymantle.com/v1",children:i,i18n:C=l,waitForCustomer:P=!1,loadingComponent:v=null})=>{const a=new V.MantleClient({appId:e,customerApiToken:n,apiUrl:s}),[r,w]=c.useState(null),[d,m]=c.useState(!0),b=async()=>{try{m(!0);const t=await a.getCustomer();w(t)}catch(t){console.error("[MantleProvider] Error fetching customer: ",t)}finally{m(!1)}},E=async t=>{await a.sendUsageEvent(t)},M=async({usageId:t,period:o})=>await a.getUsageMetricReport({id:t,period:o}),N=async t=>await a.subscribe(t),A=async({cancelReason:t}={})=>await a.cancelSubscription({...t&&{cancelReason:t}}),L=async({returnUrl:t})=>{if(!t)throw new Error("returnUrl is required");return await a.addPaymentMethod({returnUrl:t})},x=async({type:t,config:o})=>{if(!t)throw new Error("type is required");const y=new URL(document.location.toString()).searchParams.get("locale");return await a.createHostedSession({type:t,config:{...y?{locale:y}:{},...o||{}}})},Y=async()=>await a.listNotifications(),D=async({id:t})=>await a.triggerNotificationCta({id:t}),R=async({id:t,readAt:o,dismissedAt:p})=>await a.updateNotification({id:t,readAt:o,dismissedAt:p}),U=async()=>await a.getChecklist(),_=async({checklistId:t,checklistStepId:o})=>await a.completeChecklistStep({checklistId:t,checklistStepId:o});c.useEffect(()=>{n&&b()},[n]);const F=(r==null?void 0:r.plans)||[],q=(r==null?void 0:r.subscription)||null;return P&&d?v||null:B.jsx(h.Provider,{value:{client:a,customer:r,subscription:q,plans:F,loading:d,i18n:{...l,...C},sendUsageEvent:E,getUsageReport:M,subscribe:N,cancelSubscription:A,addPaymentMethod:L,createHostedSession:x,listNotifications:Y,triggerNotificationCta:D,updateNotification:R,getChecklist:U,completeChecklistStep:_,isFeatureEnabled:({featureKey:t,count:o=0})=>r!=null&&r.features[t]?T({feature:r.features[t],count:o}):!1,limitForFeature:({featureKey:t})=>r!=null&&r.features[t]&&r.features[t].type==="limit"?r.features[t].value:-1,refetch:async()=>{await b()}},children:i})},H=()=>{const e=c.useContext(h);if(e===void 0)throw new Error("useMantle must be used within a MantleProvider");return e},u=e=>e.type==="boolean"&&e.value===!0||e.type==="limit"&&e.value!==0,I=(e,n)=>Number(u(n))-Number(u(e))||e.name.localeCompare(n.name),O=(e="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:e,notation:"standard"}),$=(e,n="USD",s=!0)=>{let i=O(n).format(e);return s&&(i=i.replace(/\.00$/,"")),i};var g=(e=>(e.Annual="ANNUAL",e.Every30Days="EVERY_30_DAYS",e))(g||{});const S=(e="EVERY_30_DAYS")=>{switch(e){case"ANNUAL":return"year";case"EVERY_30_DAYS":default:return"month"}},f=(e="EVERY_30_DAYS")=>{switch(e){case"ANNUAL":return"yr";case"EVERY_30_DAYS":default:return"mo"}},G=({interval:e="EVERY_30_DAYS",useShortFormPlanIntervals:n=!0})=>n?f(e):S(e),J=({plan:e,customFieldKey:n="recommended"})=>{var s;return!!((s=e.customFields)!=null&&s[n])},Q=({plan:e,customFieldKey:n="buttonLabel"})=>{var s;return((s=e.customFields)==null?void 0:s[n])||l.subscribe},W=({plan:e})=>{var n;return((n=e.discounts)==null?void 0:n.length)>0?e.discounts.reduce((s,i)=>s.discountedAmount<i.discountedAmount?s:i):void 0},X=(e=4)=>e%4===0?{xs:6,sm:6,md:2,lg:3,xl:3}:e%3===0?{xs:6,sm:6,md:2,lg:4,xl:4}:e%2===0?{xs:6,sm:6,md:3,lg:6,xl:6}:e===1?{xs:6,sm:6,md:6,lg:12,xl:12}:{xs:6,sm:6,md:2,lg:4,xl:4},Z=(e=4)=>e%4===0?4:e%3===0?3:e%2===0?2:e===1?1:4;exports.Labels=l;exports.MantleProvider=j;exports.PlanAvailability=k;exports.PlanInterval=g;exports.columnCount=Z;exports.columnSpan=X;exports.customButtonLabel=Q;exports.featureEnabled=u;exports.featureSort=I;exports.highestDiscount=W;exports.intervalLabel=G;exports.intervalLabelLong=S;exports.intervalLabelShort=f;exports.isRecommendedPlan=J;exports.money=$;exports.useMantle=H;
//# sourceMappingURL=index.js.map
